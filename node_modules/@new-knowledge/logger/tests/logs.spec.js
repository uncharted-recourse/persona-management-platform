const path = require('path');
const { exec } = require('child_process');

const clearLogs = require('../shared/clear-saved-logs');

const { logger } = require('../index');

beforeAll(async () => {
  clearLogs();
  await logger.info('this is an info log');
  await logger.warn('this is a warn log');
  await logger.error('this is an error log');
  await logger.debug('this is a debug log');
  await logger.silly('this is a silly log');
});

test('Logger logs to logs/all-logs.log', (done) => {
  exec(`wc -l ${path.resolve('./logs/all-logs.log')} | awk '{print $1}'`, (error, results) => {
    expect(Number(results)).toEqual(4);
    done();
  });
});

test('Logger logs to logs/error.log', (done) => {
  exec(`wc -l ${path.resolve('./logs/error.log')} | awk '{print $1}'`, (error, results) => {
    expect(Number(results)).toEqual(1);
    done();
  });
});
