function produceMessage(client, kafkaProducer, topic, messages) {
  return new Promise((res, rej) => {
    client.refreshMetadata([topic], (metadataErr) => {
      if (metadataErr) {
        return rej(metadataErr);
      }
      kafkaProducer.send([
        {
          topic,
          messages,
          timestamp: Date.now()
        }
      ], (sendErr, data) => {
        if (sendErr) {
          return rej(sendErr);
        }
        return res(data);
      });
    });
  });
}

module.exports = produceMessage;
