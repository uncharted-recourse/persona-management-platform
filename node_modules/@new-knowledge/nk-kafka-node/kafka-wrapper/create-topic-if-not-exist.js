const createTopic = require('./create-topic');

function createTopicIfNotExist(client, topic) {
  return new Promise((resolve, reject) => {
    client.loadMetadataForTopics([], (error, results) => {
      if (error) {
        return reject(error);
      }
      const exsitingTopics = Object.keys(results[1].metadata);
      if (exsitingTopics.indexOf(topic) === -1) {
        createTopic(client, topic)
          .then(() => resolve(`Created topic: ${topic}`))
          .catch(err => reject(err));
      } else {
        return resolve(`Topic '${topic}' exists`);
      }
    });
  });
}

module.exports = createTopicIfNotExist;
