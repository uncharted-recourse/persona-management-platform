const Kafka = require('kafka-node');

const createClient = require('./create-client');
const produceMessage = require('./produce-message');

function createProducer() {
  return new Promise((resolve, reject) => {
    const client = createClient();
    client.on('ready', () => {
      const producer = new Kafka.Producer(client);
      producer.produce = (topic, messages) => produceMessage(client, producer, topic, messages);
      resolve(producer);
    });
  });
}

module.exports = createProducer;
