const Kafka = require('kafka-node');

function createTopic(client, topic) {
  return new Promise((resolve, reject) => {
    const tempProducer = new Kafka.Producer(client);
    client.refreshMetadata([topic], (metadataErr) => {
      if (metadataErr) {
        return reject(metadataErr);
      }
      tempProducer.createTopics([topic], false, (error, data) => {
        if (error) {
          return reject(error);
        }
        return resolve(data);
      });
    });
  });
}

module.exports = createTopic;
