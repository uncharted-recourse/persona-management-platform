const { createConsumer, createProducer } = require('./kafka-wrapper');

createConsumer([{ topic: 'topic' }, { topic: 'topic09' }, { topic: 'other-topic195' }], 'my-group')
  .then((consumer) => {
    consumer.on('message', (msg) => {
      console.log(msg);
    });
    consumer.on('error', err => console.log(err));
  })
  .catch(err => console.log(err));

createProducer()
  .then((producer) => {
    producer.produce('topic09', [JSON.stringify({
      body: {
        foo: 'mah message'
      }
    })]);
    producer.on('error', err => console.log(err));
  })
  .catch(err => console.log(err));

